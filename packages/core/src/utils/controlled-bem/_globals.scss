/* stylelint-disable scss/function-no-unknown */
/* stylelint-disable scss/dollar-variable-pattern */
@use "sass:map";
@use "sass:list";
@use './helpers.scss' as helpers;

/// GLOBALS

$HAS_EXPLICIT_TRUE: 'HAS_EXPLICIT_TRUE';
$ALL_ALLOWED: 'ALL_ALLOWED';
$IS_EXPLICITlY_DISALLOWED: 'IS_EXPLICITlY_DISALLOWED';
$ALLOW_BASE_CONTENT: 'ALLOW_BASE_CONTENT';
$BASE_CONTENT_NAME: 'base';

/*
$ENTITY_TYPE_BLOCK: 'ENTITY_TYPE_BLOCK';
$ENTITY_TYPE_ELEMENT: 'ENTITY_TYPE_ELEMENT';
$ENTITY_TYPE_MODIFIER: 'ENTITY_TYPE_MODIFIER';
$ENTITY_TYPE_RULE: 'ENTITY_TYPE_RULE';
$ENTITY_TYPE_SELECTOR: 'ENTITY_TYPE_SELECTOR';
*/
$GLOBAL_BEM_OBJECT: null;

@function init-global-bem($ruleMap, $levels, $config) {
  $GLOBAL_BEM_OBJECT: (
    'rules': $ruleMap,
    'level': $levels,
    'config': $config,
  ) !global;

  @return $GLOBAL_BEM_OBJECT;
}

@function update-global-bem-rules($ruleMap) {
  $GLOBAL_BEM_OBJECT: map.set($GLOBAL_BEM_OBJECT, 'rules', $ruleMap) !global;

  @return $GLOBAL_BEM_OBJECT;
}

@function add-global-bem-level($level) {
  $current: get-global-bem-levels();
  $updated: list.append($current, $level);
  $void: update-global-bem-levels($updated);

  @return $updated;
}

@function update-global-bem-levels($levels) {
  $GLOBAL_BEM_OBJECT: map.set($GLOBAL_BEM_OBJECT, 'levels', $levels) !global;

  @return $GLOBAL_BEM_OBJECT;
}

@function remove-current-global-bem-level() {
  $levels: get-global-bem-levels();
  $newList: helpers.pop-list($levels);

  @return update-global-bem-levels($newList);
}

@function get-global-bem($levels) {
  @return $GLOBAL_BEM_OBJECT;
}

@function get-global-bem-levels() {
  @return map.get($GLOBAL_BEM_OBJECT, 'levels');
}

@function set-global-bem-levels($levels) {
  @return map.set($GLOBAL_BEM_OBJECT, 'levels', $levels);
}

@function replace-global-bem-level($replacee, $index) {
  $newLevels: helpers.replace-list-item(get-global-bem-levels(), $replacee, $index);

  @return $newLevels;
}

@function get-global-bem-rules() {
  @return map.get($GLOBAL_BEM_OBJECT, 'rules');
}

@function get-global-bem-config() {
  @return map.get($GLOBAL_BEM_OBJECT, 'config');
}

@function is-base-name($name) {
  @return $name == $BASE_CONTENT_NAME;
}

@function get-config-value($value, $config: null) {
  $config: $config or get-global-bem-config();

  @return map.get($config, $value);
}

@function get-block-prefix($config: null) {
  @return get-config-value('blockPrefix', $config);
}

@function get-block-name($config: null) {
  @return get-config-value('blockName', $config);
}

@function get-root-selector($config: null) {
  @return get-config-value('rootSelector', $config);
}

@function get-modifier-delimeter($config: null) {
  @return get-config-value('modifierDelimeter', $config);
}

@function get-element-delimeter($config: null) {
  @return get-config-value('elementDelimeter', $config);
}
