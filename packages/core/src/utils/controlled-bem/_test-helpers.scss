/* stylelint-disable scss/function-no-unknown */
@use './helpers' as helpers;
@use "sass:map";
@use "sass:meta";
@use "sass:list";

@function diff-map($target, $expected, $diffs: []) {
  @each $key in map.keys($target) {
    $value: map.get($target, $key);
    $expectedValue: map.get($expected, $key);

    @if helpers.is-value-map($expectedValue) {
      @if not helpers.is-value-map($value) {
        $diffs: list.append($diffs, 'expected "#{$key}" to be a map, but got "#{meta.inspect($value)}"');
      } @else {
        $diffs: diff-map($value, $expectedValue, $diffs);
      }
    } @else {
      @if $value != $expectedValue {
        $diffs: list.append(
          $diffs,
          'expected "#{$key}" to be "#{$expectedValue}", but got to be "#{meta.inspect($value)}"'
        );
      }
    }
  }

  @return $diffs;
}
